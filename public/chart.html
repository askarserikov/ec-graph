<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Real-time Energy Consumption</title>
    <link rel="stylesheet" href="stylesheet.css" type="text/css">
</head>
<body>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<div class="pure-g">
    <div class="pure-u-5-24" style="margin: 10px;">
        <h3>Appliances:</h3>
        <input type="checkbox" name="lights" value="0.3"> Lights<br>
        <input type="checkbox" name="dishwasher" value="1.3"> Dishwasher<br>
        <input type="checkbox" name="sauna" value="6"> Sauna<br>
        <input type="checkbox" name="vacuum-cleaner" value="0.5"> Vacuum Cleaner<br>
        <input type="checkbox" name="ev" value="7.2"> Electric Vehicle Charger<br>
        <input type="checkbox" name="kettle" value="2.2"> Electric Kettle<br>
        <input type="checkbox" name="coffee" value="1"> Coffee Machine<br>
        <input type="checkbox" name="pc" value="0.4"> PC<br>
        <input type="checkbox" name="tv" value="0.08"> TV<br>
        <input type="checkbox" name="washing-machine" value="0.5"> Washing Machine<br>
        <input type="checkbox" name="microwave" value="1"> Microwave Oven<br>
        <input type="checkbox" name="refrigerator" value="0.15" checked disabled> Refrigerator<br>
        <input type="checkbox" name="router" value="0.01" checked disabled> WiFi Router<br>
    </div>
    <div class="pure-u-18-24" id="container"></div>
</div>
<script>
  var observations_number = -50;
  var initial_consumption = 0.16;
  var total_consumption = initial_consumption;
  var updateInterval = 2000;

  $(":checkbox").click(function () {
    total_consumption = 0;
    $(':checkbox:checked').each(function(i){
      total_consumption = total_consumption + parseFloat($(this).val());
    });
  });



  Highcharts.chart('container', {
    chart: {
      type: 'spline',
      animation: Highcharts.svg, // don't animate in old IE
      marginRight: 10,
      events: {
        load: function () {

          // set up the updating of the chart each second
          var series = this.series[0];
          setInterval(function () {
            var x = (new Date()).getTime(), // current time
              y = total_consumption;
            series.addPoint([x, y], true, true);
          }, updateInterval);
        }
      }
    },

    time: {
      useUTC: false
    },

    title: {
      text: 'Real-time Energy Consumption'
    },
    xAxis: {
      type: 'datetime',
      tickPixelInterval: 150
    },
    yAxis: {
      title: {
        text: 'kWh'
      },
      plotLines: [{
        value: 0,
        width: 1,
        color: '#003c8f'
      }]
    },
    tooltip: {
      headerFormat: '<b>{series.name}</b><br/>',
      pointFormat: '{point.x:%Y-%m-%d %H:%M:%S}<br/>{point.y:.2f}'
    },
    legend: {
      enabled: false
    },
    exporting: {
      enabled: false
    },
    series: [{
      name: 'Energy consumption',
      color: '#003c8f',
      data: (function () {
        // generate an array of random data
        var data = [],
          time = (new Date()).getTime(),
          i;

        for (i = observations_number; i <= 0; i += 1) {
          data.push({
            x: time + i * updateInterval,
            y: initial_consumption
          });
        }
        return data;
      }())
    }]
  });
</script>
</body>
</html>